{% extends 'base.html.twig' %}

{% block bookPage %} current_page {% endblock %}
{% block booksPage %} current_page {% endblock %}

{% block title %}Showing Book{% endblock %}

{% block body %}
    <h1>Details of the Book: </h1>

    <br>

    <table class="table">
    <tbody>{#
    <tr>
        <th>Id</th>
        <td>{{ book.id }}</td>
    </tr>#}
    <tr>
        <th>Title</th>
        <td>{{ book.title }}</td>
    </tr>
    <tr>
        <th>Author</th>
        <td>{{ book.author }}</td>
    </tr>
    <tr>
        <th>Barcode</th>
        <td>{{ book.barcode }}</td>
    </tr>
    <tr>
        <th>Genre</th>
        <td>{{ book.genre }}</td>
    </tr>
    <tr>
        <th>Owner</th>
        <td>{{ book.user }}</td>
    </tr>
    <tr>
        <th>Starting Bid</th>
        <td>€ {{ book.startingBid }}</td>
    </tr>
    <tr>
        <th>Current Bid</th>
        <td>€ {{ book.bid }}</td>
    </tr>
    <tr>
        <th>Bid Accepted</th>
        {% if book.bidAccepted == true %}
            <td>€{{ book.bid }} bid was accepted</td>
        {% else %}
            <td>€ {{ book.bid }} bid was not accepted</td>
            {#<td>{{ book.bidAccepted ? 'Yes' : 'No' }}</td>#}
        {% endif %}
    </tr>
    <tr>
        <th>Questions</th>
        {% if book.questions == null %}
            <td><strong>No Questions</strong></td>
        {% else %}
            <ul>
                <td>
                    <ol>
                        {% for question in book.questions %}
                            {#index of question : question text (with [" ... "] removed ) #}
                            <li style="list-style-position: inside;list-style-type: disc;text-align: left">{{ question|json_encode()|trim('["')|trim('"]')}} </li>
                            {#<br>#}
                        {% endfor %}
                    </ol>
                </td>
            </ul>
        {% endif %}
    </tr>
    <tr>
        <th>Replies</th>
        {% if book.replies == null %}
            <td><strong>No Replies to any Question</strong></td>
        {% else %}
            <ul>
                <td>
                    <ol>
                        {% for reply in book.replies %}
                            <li> *Reply goes here*</li>
                        {% endfor %}
                    </ol>
                </td>

            </ul>
        {% endif %}
    </tr>
    </tbody>

    {% if is_granted('ROLE_USER')%}
        <tr>
            <th id="actions" style="font-size: 20px">Actions:</th>
            <td>
                <h5><a href="{{ url('book_edit', {'id': book.id}) }}">Edit</a></h5>
                <hr>
                <h5><a href="{{ url('book_question', {'id': book.id}) }}">Ask Question</a></h5>
                <hr>
                {% if book.bidAccepted == false %}
                    <h5><a href="{{ url('book_bid', {'id': book.id}) }}">Bid on Book</a></h5>
                    <hr>
                {% endif %}
                {{ include('book/_delete_form.html.twig') }}
            </td>
        </tr>

        </tbody>
        </table>

        <hr>

        <h4><a href="{{ url('book_index') }}">Back to Catalog page</a><br></h4>
    {% else %}

        </tbody>
        </table>

        <h4><a href="{{ url('book_index') }}">Back to Book catalog</a></h4>
    {% endif %}

{% endblock %}
